(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}})();class y{cards;flippedCards;isBusy;moves;constructor(e){this.cards=this.shuffle(e.map((t,i)=>({id:i,value:t,state:"hidden"}))),this.flippedCards=[],this.isBusy=!1,this.moves=0}shuffle(e){let t=[...e];for(let i=t.length-1;i>0;i--){const s=Math.floor(Math.random()*(i+1));[t[i],t[s]]=[t[s],t[i]]}return t}flipCard(e){if(this.isBusy)return;const t=this.cards.find(i=>i.id===e);!t||t.state!=="hidden"||(t.state="flipped",this.flippedCards.push(t),this.flippedCards.length===2&&(this.moves++,this.checkMatch()))}checkMatch(){const[e,t]=this.flippedCards;this.isBusy=!0,e.value===t.value?(e.state="matched",t.state="matched",this.resetAfterDelay()):setTimeout(()=>{e.state="hidden",t.state="hidden",this.resetAfterDelay()},1e3)}resetAfterDelay(){this.flippedCards=[],this.isBusy=!1}isGameOver(){return this.cards.every(e=>e.state==="matched")}restart(){this.cards.forEach(e=>e.state="hidden"),this.cards=this.shuffle(this.cards),this.flippedCards=[],this.isBusy=!1,this.moves=0}}class v{element;front;back;data;onClick;constructor(e,t){this.data=e,this.onClick=t,this.element=document.createElement("div"),this.element.classList.add("card"),this.element.addEventListener("click",()=>this.handleClick()),this.front=document.createElement("div"),this.front.classList.add("front"),this.front.textContent=e.value,this.back=document.createElement("div"),this.back.classList.add("back"),this.back.textContent="?",this.element.appendChild(this.front),this.element.appendChild(this.back),this.updateVisual(this.data.state)}handleClick(){this.data.state==="hidden"&&this.onClick(this)}updateVisual(e){this.data.state=e,this.element.classList.remove("flipped","matched"),(e==="flipped"||e==="matched")&&this.element.classList.add("flipped"),e==="matched"&&this.element.classList.add("matched")}getElement(){return this.element}}const C=["🍎","🍌","🍇","🍒","🍋","🍉","🥝","🍓"];let a,o=null,c=0;const l=document.getElementById("game-board"),g=document.getElementById("restart-btn"),u=document.getElementById("moves"),f=document.getElementById("timer"),p=document.getElementById("win-modal"),E=document.getElementById("win-text"),L=document.getElementById("play-again-btn"),b=document.getElementById("difficulty");function B(){h(),c=0,f.textContent="Time: 0 s",o=window.setInterval(()=>{c++,f.textContent=`Time: ${c} s`},1e3)}function h(){o!==null&&(clearInterval(o),o=null)}function I(){h(),E.textContent=`Вы нашли все пары за ${a.moves} ходов и ${c} секунд!`,p.classList.add("active")}function M(){p.classList.remove("active")}function k(){l.innerHTML="";const d=[];a.cards.forEach(e=>{const t=new v(e,i=>{a.flipCard(i.data.id),a.cards.forEach(s=>{const n=d.find(r=>r.data.id===s.id);n&&n.updateVisual(s.state)}),u.textContent=`Moves: ${a.moves}`,a.moves===1&&!o&&B(),a.isGameOver()&&setTimeout(I,400)});t.getElement().style.animationDelay=`${Math.random()*.5}s`,l.appendChild(t.getElement()),d.push(t)})}function m(){l.classList.add("fade-out"),setTimeout(()=>{const d=Number(b.value),e=C.slice(0,d);a=new y([...e,...e]),u.textContent="Moves: 0",h(),k(),l.classList.remove("fade-out")},300)}g.addEventListener("click",m);L.addEventListener("click",()=>{M(),m()});m();
